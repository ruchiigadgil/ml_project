image: python:3.9

stages:
  - install
  - test
  - train
  - validate

before_script:
  # if the project files live in a subfolder, change into it so CI commands run there
  - |
    if [ -f MLOPS_EXP3/ruchigadgil-project/requirements.txt ]; then
      echo "Found subproject at MLOPS_EXP3/ruchigadgil-project, changing directory";
      cd MLOPS_EXP3/ruchigadgil-project;
    fi
  - python -m pip install --upgrade pip
  - python -m pip install -r requirements.txt

test_model:
  stage: test
  script:
    - echo "Running unit tests..."
    - python -m pytest -q tests/

train_model:
  stage: train
  script:
    - echo "Training model..."
    - python train.py

validate_model:
  stage: validate
  script:
    - echo "Validating model..."
    - python validate.py
